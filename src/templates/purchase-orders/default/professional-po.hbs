<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Purchase Order {{OrderNumber}}</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', 'Helvetica', sans-serif;
      font-size: 10pt;
      color: #333;
      line-height: 1.4;
      padding: 20mm;
    }

    .page {
      max-width: 210mm;
      margin: 0 auto;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      border-bottom: 3px solid #003366;
      padding-bottom: 15px;
      margin-bottom: 20px;
    }

    .company-details {
      flex: 1;
    }

    .company-name {
      font-size: 18pt;
      font-weight: bold;
      color: #003366;
      margin-bottom: 5px;
    }

    .company-abn {
      font-size: 10pt;
      margin-bottom: 3px;
    }

    .company-info {
      font-size: 9pt;
      color: #666;
    }

    .document-title {
      text-align: right;
    }

    .document-title h1 {
      font-size: 20pt;
      color: #003366;
      margin-bottom: 8px;
    }

    .order-meta {
      font-size: 10pt;
      margin-bottom: 3px;
    }

    .order-meta strong {
      color: #003366;
    }

    /* Contact Boxes */
    .contact-section {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .contact-box {
      flex: 1;
      border: 1px solid #999;
      padding: 10px;
      background: #f9f9f9;
    }

    .contact-box-title {
      font-size: 8pt;
      font-weight: bold;
      text-decoration: underline;
      margin-bottom: 5px;
      color: #003366;
    }

    .contact-box-content {
      font-size: 9pt;
      line-height: 1.5;
    }

    /* Section Headers */
    .section-header {
      font-size: 11pt;
      font-weight: bold;
      color: #003366;
      margin: 15px 0 10px 0;
    }

    .cost-centre {
      font-size: 10pt;
      margin-bottom: 8px;
    }

    /* Items Table */
    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }

    .items-table thead {
      background: #e0e0e0;
    }

    .items-table th {
      padding: 8px;
      text-align: left;
      font-size: 9pt;
      font-weight: bold;
      border: 1px solid #999;
      color: #003366;
    }

    .items-table td {
      padding: 6px 8px;
      font-size: 9pt;
      border: 1px solid #ccc;
    }

    .items-table tr:nth-child(even) {
      background: #f9f9f9;
    }

    .items-table .col-code {
      width: 12%;
    }

    .items-table .col-desc {
      width: 48%;
    }

    .items-table .col-qty {
      width: 10%;
      text-align: right;
    }

    .items-table .col-unit {
      width: 8%;
      text-align: center;
    }

    .items-table .col-price {
      width: 12%;
      text-align: right;
    }

    .items-table .col-total {
      width: 12%;
      text-align: right;
      font-weight: bold;
    }

    .item-workup {
      font-size: 8pt;
      color: #666;
      font-style: italic;
      padding-left: 10px;
      margin-top: 2px;
    }

    /* Notes Section */
    .notes-section {
      margin: 20px 0;
    }

    .notes-title {
      font-size: 10pt;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .notes-content {
      font-size: 9pt;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    /* Important Notices */
    .notice-box {
      border: 2px solid #003366;
      padding: 12px;
      margin: 15px 0;
      background: #f0f5f9;
      text-align: center;
    }

    .notice-box strong {
      font-size: 10pt;
      color: #003366;
    }

    .notice-box p {
      font-size: 8pt;
      margin: 5px 0;
      line-height: 1.4;
    }

    /* Terms Box */
    .terms-box {
      border: 2px solid #666;
      padding: 12px;
      margin: 15px 0;
      font-size: 8pt;
      line-height: 1.5;
    }

    .terms-box strong {
      font-weight: bold;
      text-decoration: underline;
    }

    /* Signature Section */
    .signature-section {
      margin-top: 30px;
      padding-top: 15px;
      border-top: 1px solid #ccc;
    }

    .signature-line {
      margin: 20px 0;
      font-size: 9pt;
    }

    .signature-line strong {
      display: inline-block;
      width: 150px;
    }

    .signature-line .dotted-line {
      display: inline-block;
      border-bottom: 1px dotted #333;
      width: 300px;
      margin: 0 10px;
    }

    /* Footer */
    .footer {
      margin-top: 30px;
      padding-top: 15px;
      border-top: 2px solid #003366;
      text-align: center;
      font-size: 9pt;
    }

    .footer strong {
      color: #003366;
    }

    /* Print Styles */
    @media print {
      body {
        padding: 0;
      }

      .page-break {
        page-break-after: always;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- Header -->
    <div class="header">
      <div class="company-details">
        <div class="company-name">{{#if customizations.content.companyName}}{{customizations.content.companyName}}{{else}}[Company Name]{{/if}}</div>
        <div class="company-abn">A.B.N. {{#if customizations.content.companyABN}}{{customizations.content.companyABN}}{{else}}[Company ABN]{{/if}}</div>
        <div class="company-info">
          {{#if customizations.content.companyDetails}}
            {{{customizations.content.companyDetails}}}
          {{else}}
            [Company Details]
          {{/if}}
        </div>
      </div>

      <div class="document-title">
        <h1>PURCHASE ORDER</h1>
        <div class="order-meta"><strong>Order Number:</strong> {{OrderNumber}}</div>
        <div class="order-meta"><strong>Order Date:</strong> {{formatDate OrderDate 'DD/MM/YYYY'}}</div>
        {{#if DelDate}}
          <div class="order-meta"><strong>Delivery Date:</strong> {{formatDate DelDate 'DD/MM/YYYY'}}</div>
        {{/if}}
      </div>
    </div>

    <!-- Contact Section -->
    <div class="contact-section">
      <div class="contact-box">
        <div class="contact-box-title">Supplier:</div>
        <div class="contact-box-content">
          <strong>{{SupplierName}}</strong><br>
          {{#if SupplierAddress}}
            {{SupplierAddress}}<br>
          {{/if}}
          {{#if AccountAddress}}
            {{AccountAddress}}<br>
          {{/if}}
          {{#if AccountCity}}
            {{AccountCity}}{{#if AccountState}}, {{AccountState}}{{/if}}{{#if AccountPostcode}} {{AccountPostcode}}{{/if}}<br>
          {{/if}}
          {{#if AccountPhone}}
            Ph: {{AccountPhone}}<br>
          {{/if}}
          {{#if AccountContact}}
            Contact: {{AccountContact}}
          {{/if}}
        </div>
      </div>

      <div class="contact-box">
        <div class="contact-box-title">Job Address:</div>
        <div class="contact-box-content">
          {{#if JobName}}
            <strong>{{JobName}}</strong><br>
          {{/if}}
          {{#if SiteStreet}}
            {{SiteStreet}}<br>
          {{/if}}
          {{#if SiteSuburb}}
            {{SiteSuburb}}{{#if SiteState}}, {{SiteState}}{{/if}}<br>
          {{/if}}
          {{#if Supervisor}}
            <strong>Supervisor:</strong> {{Supervisor}}<br>
          {{/if}}
          {{#if SupervisorPhone}}
            {{SupervisorPhone}}
          {{/if}}
        </div>
      </div>
    </div>

    <!-- Order Details -->
    <div class="section-header">Please Supply:</div>
    {{#if CostCentreName}}
      <div class="cost-centre">{{CostCentreName}}</div>
    {{/if}}

    <!-- Items Table -->
    <table class="items-table">
      <thead>
        <tr>
          <th class="col-code">Code</th>
          <th class="col-desc">Description</th>
          <th class="col-qty">Quantity</th>
          <th class="col-unit">Unit</th>
          {{#if showLinePrices}}
            <th class="col-price">Unit Price</th>
            <th class="col-total">Total</th>
          {{/if}}
        </tr>
      </thead>
      <tbody>
        {{#each items}}
          <tr>
            <td class="col-code">{{ItemCode}}</td>
            <td class="col-desc">
              {{Description}}
              {{#if Workup}}
                <div class="item-workup">{{Workup}}</div>
              {{/if}}
            </td>
            <td class="col-qty">{{formatNumber Quantity 2}}</td>
            <td class="col-unit">{{Unit}}</td>
            {{#if ../showLinePrices}}
              <td class="col-price">{{currency UnitPrice}}</td>
              <td class="col-total">{{currency LineTotal}}</td>
            {{/if}}
          </tr>
        {{/each}}

        {{#if showPrices}}
          <!-- Totals Row -->
          <tr>
            <td colspan="{{#if showLinePrices}}4{{else}}4{{/if}}" style="text-align: right; font-weight: bold; border-top: 2px solid #333;">Subtotal:</td>
            {{#if showLinePrices}}
              <td class="col-total" style="border-top: 2px solid #333;">{{currency SubTotal}}</td>
            {{/if}}
          </tr>

          {{#ifEquals gstMode 'total'}}
            <tr>
              <td colspan="{{#if showLinePrices}}4{{else}}4{{/if}}" style="text-align: right; font-weight: bold;">GST (10%):</td>
              {{#if showLinePrices}}
                <td class="col-total">{{currency GSTAmount}}</td>
              {{/if}}
            </tr>
            <tr>
              <td colspan="{{#if showLinePrices}}4{{else}}4{{/if}}" style="text-align: right; font-weight: bold; font-size: 11pt;">TOTAL:</td>
              {{#if showLinePrices}}
                <td class="col-total" style="font-size: 11pt; background: #e0e0e0;">{{currency GrandTotal}}</td>
              {{/if}}
            </tr>
          {{/ifEquals}}
        {{/if}}
      </tbody>
    </table>

    <!-- Additional Notes -->
    {{#if SpecialInstructions}}
      <div class="notes-section">
        <div class="notes-title">Additional Notes and Instructions:</div>
        <div class="notes-content">{{SpecialInstructions}}</div>
      </div>
    {{/if}}

    {{#if globalNotes}}
      {{#each globalNotes}}
        <div class="notes-section">
          <div class="notes-content">{{NoteText}}</div>
        </div>
      {{/each}}
    {{/if}}

    <!-- Important Notice -->
    <div class="notice-box">
      <strong>*** Notify Supervisor Prior to Attending Site ***</strong>
      <p>Sign on to Site Attendance Log. Work safety plan and insurance details must be submitted before attending the work site.</p>
    </div>

    <!-- Terms and Conditions -->
    <div class="terms-box">
      <p><strong>All invoices to {{#if customizations.content.companyName}}{{customizations.content.companyName}}{{else}}[Company Name]{{/if}} MUST contain the Purchase Order Number {{OrderNumber}} for the invoice to be paid.</strong></p>
      <p>Invoices not clearly stating the P.O. will be returned to the contractor or supplier.</p>
      <p>Invoices in excess of the P.O. will not be paid without prior written authority from {{#if customizations.content.companyName}}{{customizations.content.companyName}}{{else}}[Company Name]{{/if}}.</p>
      <p>Work carried out and goods supplied must meet the BCOA Standards.</p>
      <br>
      <p><strong>**** To ensure prompt attention to your invoice ****</strong></p>
      <p>Supply the site supervisor {{Supervisor}} with the delivery docket and PO for signing as being completed - Photocopy the signed PO and return with your invoice to our office.</p>
    </div>

    <!-- Signature Section -->
    <div class="signature-section">
      <div class="signature-line">
        <strong>Goods Supplied:</strong>
        <span class="dotted-line"></span>
        <strong>{{Supervisor}}</strong>
      </div>
      <div class="signature-line">
        <strong>Date:</strong>
        <span class="dotted-line"></span>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>This order is subject to our Standard Terms and Conditions.</p>
      {{#if customizations.content.authorizedBy}}
        <p><strong>Authorised by:</strong> {{customizations.content.authorizedBy}}</p>
      {{/if}}
      <p style="font-size: 7pt; color: #999; margin-top: 10px;">Generated: {{formatDate currentDate 'DD/MM/YYYY'}}</p>
    </div>
  </div>
</body>
</html>
